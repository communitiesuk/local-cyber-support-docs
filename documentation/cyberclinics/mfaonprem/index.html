<!doctype html>
<html lang="en" class="govuk-template no-js">
  <head>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>MFA ONPrem - DLUHC Technical Documentation Library</title>

    <link href="/local-cyber-support-docs/stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://github.com/communitiesuk/local-cyber-support-docs/local-cyber-support-docs/documentation/cyberclinics/mfaonprem/">

      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="github.com" />
      <meta name="twitter:image" content="https://github.com/communitiesuk/local-cyber-support-docs/images/govuk-large.png" />
      <meta name="twitter:title" content="MFA ONPrem - DLUHC Technical Documentation Library" />
      <meta name="twitter:url" content="https://github.com/communitiesuk/local-cyber-support-docs/local-cyber-support-docs/documentation/cyberclinics/mfaonprem/" />

      <meta property="og:image" content="https://github.com/communitiesuk/local-cyber-support-docs/images/govuk-large.png" />
      <meta property="og:site_name" content="DLUHC Technical Documentation Library" />
      <meta property="og:title" content="MFA ONPrem" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://github.com/communitiesuk/local-cyber-support-docs/local-cyber-support-docs/documentation/cyberclinics/mfaonprem/" />

    
  </head>

  <body class="govuk-template__body">
    <script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>

    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="https://github.com/communitiesuk/local-cyber-support-docs" class="govuk-header__link govuk-header__link--homepage">
        <span class="govuk-header__product-name">
          DLUHC Technical Documentation Library
        </span>
      </a>
        <strong class="govuk-tag">Beta</strong>
    </div>
    <div class="govuk-header__content">
      <nav class="govuk-header__navigation govuk-header__navigation--end" aria-label="Menu">
        <button type="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" aria-label="Show or hide menu">Menu</button>
        <ul id="navigation" class="govuk-header__navigation-list">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="https://github.com/alphagov/tech-docs-template">Template</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="https://github.com/alphagov/tech-docs-gem">Ruby gem</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/support">Support</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body" data-module="in-page-navigation">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1" aria-label="Table of contents" role="dialog">
              
              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading" data-module="collapsible-navigation">
                      <ul>
  <li>
    <a href="/local-cyber-support-docs/"><span>DLUHC Technical Documentation Library</span></a>
  </li>
<li><a href="/local-cyber-support-docs/documentation/activedirectory/"><span>Active Directory</span></a>
<ul>
  <li>
    <a href="/local-cyber-support-docs/documentation/activedirectory/password/"><span>AD and Password Best Practices.</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/activedirectory/finegrained/"><span>Overview of fine grained password policy implementation</span></a>
  </li>
</ul>
</li>
<li><a href="/local-cyber-support-docs/documentation/ncscacd/"><span>NCSC ACD</span></a>
<ul>
  <li>
    <a href="/local-cyber-support-docs/documentation/ncscacd/acd/"><span>ACD Introduction</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/ncscacd/lme/"><span>LME support</span></a>
  </li>
</ul>
</li>
<li><a href="/local-cyber-support-docs/documentation/mfa/"><span>MFA</span></a>
<ul>
  <li>
    <a href="/local-cyber-support-docs/documentation/mfa/byod/"><span>Overview of BYOD best practice</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/mfa/bestpractice/"><span>Overview of MFA best practice</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/mfa/condaccess/"><span>Overview of conditional access policies best practice</span></a>
  </li>
</ul>
</li>
<li><a href="/local-cyber-support-docs/documentation/logging/"><span>Logging</span></a>
<ul>
  <li>
    <a href="/local-cyber-support-docs/documentation/logging/guidance/"><span>Guidance for logging</span></a>
  </li>
</ul>
</li>
<li><a href="/local-cyber-support-docs/documentation/backup/"><span>Backup</span></a>
<ul>
  <li>
    <a href="/local-cyber-support-docs/documentation/backup/m365/"><span>Backing up Microsoft 365 : Guidance</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/backup/rbacme/"><span>Role Based Access Control Model Example</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/backup/txlogs/"><span>Overview of database transaction logs backups</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/backup/offline/"><span>Overview of offline backup best practice</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/backup/bestpractice/"><span>Overview of backup best practice</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/backup/maintenanceplans/"><span>Overview of MS-SQL server database maintenance plans</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/backup/rbac/"><span>Overview of role based access control & least privilege best practice</span></a>
  </li>
</ul>
</li>
<li><a href="/local-cyber-support-docs/documentation/healthcheck/"><span>IT Health Check</span></a>
<ul>
  <li>
    <a href="/local-cyber-support-docs/documentation/healthcheck/logging/"><span>Guidance for logging</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/healthcheck/psc/"><span>ITHC Principle Security Concerns</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/healthcheck/openvas/"><span>OpenVAS guidance</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/healthcheck/template/"><span>ITHC template</span></a>
  </li>
</ul>
</li>
<li><a href="/local-cyber-support-docs/documentation/operatingsystems/"><span>Operating Systems</span></a>
<ul>
  <li>
    <a href="/local-cyber-support-docs/documentation/operatingsystems/secureteams/"><span>Overview of Considerations for Securing Microsoft Teams</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/operatingsystems/endpointsecurity/"><span>Overview of Endpoint Device Security Elements</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/operatingsystems/bestpractice/"><span>Device & MS365 Hardening</span></a>
  </li>
</ul>
</li>
<li><a href="/local-cyber-support-docs/documentation/bcdr/"><span>BC & DR</span></a>
<ul>
  <li>
    <a href="/local-cyber-support-docs/documentation/bcdr/bcdrprep/"><span>Overview of BC/DR test preparation</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/bcdr/itdr/"><span>IT Disaster Recovery Planning</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/bcdr/bcdrplan/"><span>Overview of BC/DR plan preparation</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/bcdr/resilience/"><span>Resilience business impact assessment</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/bcdr/rto/"><span>Overview of RTO & RPO</span></a>
  </li>
</ul>
</li>
<li><a href="/local-cyber-support-docs/documentation/cyberclinics/"><span>Cyber Clinics</span></a>
<ul>
  <li>
    <a href="/local-cyber-support-docs/documentation/cyberclinics/adtool/"><span>Active Directory Toolkit</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/cyberclinics/offlinebackup/"><span>Why should we have offline backups ?</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/cyberclinics/conditionalaccess/"><span>Conditional Access Policies</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/cyberclinics/exchange/"><span>Exchange On Premise</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/cyberclinics/mfaonprem/"><span>Use of MFA for on premise privileged accounts</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/cyberclinics/vulnscanning/"><span>Vulnerability Scanning with Greenbone Security Manager</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/cyberclinics/hambleton/"><span>RTO/RPO</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/cyberclinics/atp/"><span>Microsoft 365 Advanced Threat Protection</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/cyberclinics/passwords/"><span>Passwords and identity protection</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/cyberclinics/gbb/"><span>Cyber Security - Good, Better, Best.</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/cyberclinics/m365backup/"><span>Backing up Microsoft 365 : Why Bother?</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/cyberclinics/passwordcontrol/"><span>Cyber Security - Password Control</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/cyberclinics/bcdr/"><span>Incident Management</span></a>
  </li>
  <li>
    <a href="/local-cyber-support-docs/documentation/cyberclinics/lme/"><span>Logging Made Easy (LME)</span></a>
  </li>
</ul>
</li>
</ul>


              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
            <h1 id="use-of-mfa-for-on-premise-privileged-accounts">Use of MFA for on premise privileged accounts</h1>
<p><font size="5"><strong>Agenda</strong></font></p>
<p>Use of MFA for on premise privileged accounts</p>

<ul>
<li><p>Overview</p></li>
<li><p>Best practices for MFA</p></li>
<li><p>Why MFA is important</p></li>
<li><p>Implementation considerations</p></li>
<li><p>Examples of products</p></li>
<li><p>Summary</p></li>
</ul>
<p><font size="5"><strong>Overview</strong></font></p>
<p>Multi Factor Authentication works on the principle of requiring more than one of these items:</p>

<ul>
<li><p>Something you have (such an authentication application on your phone)</p></li>
<li><p>Something you know (such as your username and password)</p></li>
<li><p>Something you are (such as fingerprint or iris recognition)</p></li>
</ul>
<p><img src="../../../assets/cyberclinics/MFAOP01.png" /></p>
<p><font size="5"><strong>Best Practices</strong></font></p>
<p>Best practices for the usage of MFA include :-</p>

<ul>
<li><p>Protection of Online Administrative Accounts (Such as M365 Global Administrators)</p></li>
<li><p>Protection of Internal Domain Privileged Accounts (Such as Domain Administrators, SAN Administrators, - - Backup Server Accounts)</p></li>
<li><p>Protection of User Accounts for Remote Access</p></li>
<li><p>Protection of Regular M365 User Accounts when not in ‘Whitelisted’ locations</p></li>
</ul>
<p><font size="5"><strong>Why MFA is important</strong></font></p>
<p><strong>Using MFA on On Premise Privileged User Accounts:</strong></p>

<ul>
<li>These accounts are extremely important and unauthorised usage can result in significant damage to internal systems. As with other items listed, requiring additional authentication will help protect the accounts even if a valid username and password are used to access key services such as Domain Controllers, Storage Systems, etc.</li>
</ul>
<p><strong>Using MFA on M365 User Accounts when not onsite:</strong></p>

<ul>
<li>By using a specific type of Conditional Access Policy you can require a user to use MFA when accessing their emails or Microsoft 365 located files when they are not connected to your local network, or trusted locations. This will reduce user impact by allowing them to connect with just usernames and passwords when working internally.</li>
</ul>
<p><font size="5"><strong>Examples of products for on premise MFA</strong></font></p>

<ul>
<li><p>For On Premise Domain accounts (privileged or not) you can use any number of MFA systems, some are Free, others are chargeable. Suitability should be assessed before selecting one. The old adage of ‘You get what you pay for’ is quite true with technologies of this type !</p></li>
<li><p>Many premium (chargeable) products give a free trial so you can see suitability.</p>
<p>Options include but are not limited to Microsoft Authenticator App, Google Authenticator App, Cisco Duo, RSA.</p></li>
<li><p>For Standalone Systems check with the system manufacturer for compatibility with MFA Solutions.</p></li>
</ul>
<p><font size="5"><strong>How does MFA work ?</strong></font></p>
<p><img src="../../../assets/cyberclinics/MFAOP02.png" /></p>
<p><font size="5"><strong>MFA ‘transactions’</strong></font></p>
<p><img src="../../../assets/cyberclinics/MFAOP03.png" /></p>

<ol>
<li><p>The client device establishes a connection</p></li>
<li><p>The target device refers to the AD for approval</p></li>
<li><p>If approved the target device then contacts Duo</p></li>
<li><p>Duo then contacts the MFA device (usually the users mobile device</p></li>
<li><p>If Duo approves the target device is notified to allow a connection</p></li>
<li><p>The target device notifies the client device and allows connectivity</p></li>
</ol>
<p><font size="5"><strong>Overview of installation for a specific server</strong></font></p>
<p>To integrate Duo with Windows RDP, you simply have to run the Duo Authentication for Windows Logon installer on your Microsoft session host with admin privileges.</p>
<p>During the installation, you’ll enter in the integration key, secret key and API hostname that Duo provides you.</p>
<p>In addition, you can customize a few different policy options (like bypassing auth if the device is offline, or using auto push) as part of the installation process.</p>
<p>Now when you log into a Windows Server, you’ll automatically be prompted for two-factor authentication after providing primary login credentials.</p>
<p>https://duo.com/blog/protecting-windows-servers-and-remote-desktops-with-duo</p>
<p><font size="5"><strong>Jump Servers, RBAC Integration &amp; MFA</strong></font></p>
<p>Consider the use of Jump Servers with the relevant administration tools on them (eg Active Directory Management, SQL Management, Exchange Management, etc) as the servers to implement MFA onto.</p>
<p>Your privileged users should use their MFA enabled privileged accounts to log onto these servers to carry out the administrative tasks, rather than going to the servers directly.</p>
<p><font size="5"><strong>Final considerations*:</strong></font></p>

<ul>
<li><p>You will need to consider how administrators can gain access to the service if multi-factor authentication is unavailable. This could be caused by a service configuration or the loss of an authentication token.</p></li>
<li><p>Creating an emergency (‘break glass’) account would give you the capability to log in to a server which has administrative accounts protected by MFA in the event of an MFA service failure. These accounts should have hyper-complex passwords and known only to a small number of high level administrators, ideally in a Password ‘Safe’ product, so the passwords are not easily viewed.</p></li>
<li><p>Accounts such as an emergency or &lsquo;break glass&rsquo; accounts that use a single authentication factor should be the subject of increased protective monitoring so that its misuse can be easily detected.</p></li>
</ul>
<p>*https://www.ncsc.gov.uk/guidance/multi-factor-authentication-online-services</p>
<p><font size="5"><strong>Further Reading</strong></font></p>
<p><font size="4"><strong>Overview:</strong></font></p>
<p>https://www.microsoft.com/en-us/security/business/identity-access-management/mfa-multi-factor-authentication</p>
<p><font size="4"><strong>On Premise Options (No Integration with Azure AD)</strong></font></p>
<p><font size="3"><strong>Manageengine ADSelfService Plus:</strong></font></p>
<p>https://www.manageengine.com/products/self-service-password/windows-logon-two-factor-authentication.html?lhs</p>
<p><font size="3"><strong>Cisco Duo:</strong></font></p>
<p>https://duo.com/blog/protecting-windows-servers-and-remote-desktops-with-duo</p>
<p>https://duo.com/docs/rdp</p>
<p><font size="4"><strong>Where Active Directory is Integrated into Azure AD (M365):</strong></font></p>
<p><font size="3"><strong>Azure MFA</strong></font></p>
<p>https://docs.microsoft.com/en-GB/azure/active-directory/fundamentals/concept-fundamentals-mfa-get-started</p>

            
          </main>

          <aside>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">

        <ul class="govuk-footer__inline-list">
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/accessibility/">Accessibility</a>
            </li>
        </ul>

      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="/local-cyber-support-docs/javascripts/application.js"></script>
  </body>
</html>
